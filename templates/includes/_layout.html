<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>{% block title %}Painel - Vida Efat치{% endblock %}</title>

  <!-- Bootstrap -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.0/font/bootstrap-icons.css" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">

  <style>
    :root { --bs-body-font-family:'Inter',sans-serif; }
    body { background:#f8f9fa;font-size:.925rem; }
    .sidebar {
      position:fixed;top:0;left:0;height:100vh;width:240px;
      background-color:#0d6efd;color:#fff;padding:20px 15px;overflow-y:auto;
    }
    .btn-menu{
      width:100%;text-align:left;margin-bottom:8px;color:#fff;border:1px solid rgba(255,255,255,0.2);
    }
    .btn-menu:hover, .btn-menu.active{
      background-color:rgba(255,255,255,.15);
      color:#fff;
    }
    .content{margin-left:260px;padding:25px;}
    footer{margin-left:260px;}
  </style>
</head>
<body>

  <!-- MENU LATERAL -->
  <div class="sidebar">
    <h5 class="mb-4"><i class="bi bi-cross"></i> Vida Efat치</h5>

    <!-- In칤cio -->
    <a href="{{ url_for('index') }}" 
       class="btn btn-menu btn-outline-light {% if request.endpoint == 'index' %}active{% endif %}">
      <i class="bi bi-house-door"></i> In칤cio
    </a>

    {% if current_user.is_authenticated and current_user.nivel_acesso <= 3 %}
      <!-- 游릱 ADMIN OU LIDERAN칂A -->
      <a href="{{ url_for('secretaria') }}" 
         class="btn btn-menu btn-outline-light {% if 'secretaria' in request.endpoint %}active{% endif %}">
        <i class="bi bi-journal-text"></i> Secretaria
      </a>
      <a href="{{ url_for('listar_membros') }}" 
         class="btn btn-menu btn-outline-light {% if 'membro' in request.endpoint %}active{% endif %}">
        <i class="bi bi-people"></i> Membros
      </a>
      <a href="{{ url_for('financeiro') }}" 
         class="btn btn-menu btn-outline-light {% if 'financeiro' in request.endpoint and not 'membro' in request.endpoint %}active{% endif %}">
        <i class="bi bi-cash-stack"></i> Financeiro
      </a>
      <a href="{{ url_for('usuarios_listar') }}" 
         class="btn btn-menu btn-outline-light {% if 'usuarios' in request.endpoint %}active{% endif %}">
        <i class="bi bi-person-gear"></i> Usu치rios
      </a>
      <a href="{{ url_for('novo_evento') }}" 
         class="btn btn-menu btn-outline-light {% if 'evento' in request.endpoint %}active{% endif %}">
        <i class="bi bi-calendar-event"></i> Eventos
      </a>

    {% else %}
      <!-- 游릴 MEMBRO COMUM -->
      <a href="{{ url_for('financeiro_membro') }}" 
         class="btn btn-menu btn-outline-light {% if 'financeiro_membro' in request.endpoint %}active{% endif %}">
        <i class="bi bi-journal-text"></i> Secretaria
      </a>
      <a href="{{ url_for('financeiro_membro') }}" 
         class="btn btn-menu btn-outline-light {% if 'financeiro_membro' in request.endpoint %}active{% endif %}">
        <i class="bi bi-wallet2"></i> Meu Financeiro
      </a>
      <a href="{{ url_for('novo_evento') }}" 
         class="btn btn-menu btn-outline-light {% if 'evento' in request.endpoint %}active{% endif %}">
        <i class="bi bi-calendar-event"></i> Eventos
      </a>
    {% endif %}

    <hr class="text-light">

    <a href="{{ url_for('logout') }}" class="btn btn-outline-light btn-sm w-100">
      <i class="bi bi-box-arrow-right"></i> Sair
    </a>

    <div class="mt-4 small text-white-50">
      <i class="bi bi-person-circle"></i> {{ current_user.nome }}
    </div>
  </div>

  <!-- CONTE칔DO PRINCIPAL -->
  <div class="content">
    {% with messages=get_flashed_messages(with_categories=true) %}
      {% if messages %}
        {% for category,message in messages %}
          <div class="alert alert-{{ 'danger' if category=='error' else category }} alert-dismissible fade show">
            {{ message }}
            <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
          </div>
        {% endfor %}
      {% endif %}
    {% endwith %}

    {% block content %}{% endblock %}

    <div class="mt-4">
      <a href="{{ request.referrer or url_for('index') }}" class="btn btn-outline-secondary">
        <i class="bi bi-arrow-left"></i> Voltar
      </a>
    </div>
  </div>

  <!-- RODAP칄 -->
  <footer class="bg-dark text-white text-center py-3 mt-5">
    <div class="container">
      <p class="mb-0">&copy; {{ current_year }} Comunidade Batista Vida Efat치</p>
      <small>Desenvolvido com <i class="bi bi-heart-fill text-danger"></i> por Secretaria</small>
    </div>
  </footer>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</body>
</html>
